@{
    ViewData["Title"] = "HoSoBN";
    Layout = "~/Views/Shared/Bs_Layout.cshtml";
    <link rel="stylesheet" href="~/css/hosobn.css" asp-append-version="true" />
}
<body>
    <div class="search-container">
        <input type="text" id="searchInput" placeholder="Nhập số điện thoại bệnh nhân" />
        <button onclick="searchPatient()">Tìm kiếm</button>
    </div>

    <!-- Nút để mở form thêm mới -->
    <button onclick="showAddForm()">Thêm Hồ Sơ Bệnh Nhân</button>
    
    <div class="patient-list">
        <h2>Danh Sách Hồ Sơ Bệnh Nhân</h2>
        <table>
            <thead>
                <tr>
                    <th>Mã hồ sơ</th>
                    <th>Tên Bệnh Nhân</th>
                    <th>Số Điện Thoại</th>
                    <th>Địa Chỉ</th>
                    <th>Ngày Sinh</th>
                    <th>Giới Tính</th>
                    <th>Email</th>
                    <th>Mô Tả Bệnh</th>
                    <th>Hành động</th>
                </tr>
            </thead>
            @foreach (var hs in ViewBag.list){
                <tbody id="patientTableBody">
                    <tr>
                        <td>@hs[0]</td>
                        <td>@hs[2]</td>
                        <td>@hs[3]</td>
                        <td>@hs[4]</td>
                        <td>@hs[5]</td>
                        <td>@hs[6]</td>
                        <td>@hs[7]</td>
                        <td>@hs[8]</td>
                        <td>
                            <a href="~/Bacsis/XoaHs?id=@hs[0]" onclick="return confirm('Bạn có chắc chắn muốn xóa không?')">xóa</a>
                            <button onclick="editPatient(@hs[0], '@hs[3]', '@hs[8]')">sửa</button>
                        </td>
                    </tr>
                </tbody>      
            }
        </table> 
    </div>

    <!-- Modal Thêm Hồ Sơ -->
    <div id="addPatientFormModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="hideForm()">&times;</span>
            <h3>Thêm Hồ Sơ Bệnh Nhân</h3>
            
            <!-- Form thêm hồ sơ bệnh nhân -->
            <form id="addPatientForm" asp-controller="Bacsis" asp-action="ThemHs" method="post">
                <label>Số Điện Thoại:</label>
                <input type="text" id="patientPhone" name="patientPhone" required />
                
                <label>Mô Tả Bệnh:</label>
                <textarea id="patientDescription" name="patientDescription"></textarea>
                
                <button type="submit">Lưu</button>
            </form>
        </div>
    </div>

    <!-- Modal Sửa Hồ Sơ -->
    <div id="editPatientFormModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="hideForm()">&times;</span>
            <h3>Sửa Hồ Sơ Bệnh Nhân</h3>
            
            <!-- Form sửa hồ sơ bệnh nhân -->
            <form id="editPatientForm" asp-controller="Bacsis" asp-action="Suahoso" method="post">
                <input type="hidden" id="patientId" name="patientId" />
                
                <label>Số Điện Thoại:</label>
                <input type="text" id="editPatientPhone" name="patientPhone" readonly />
                
                <label>Mô Tả Bệnh:</label>
                <textarea id="editPatientDescription" name="patientDescription"></textarea>
                
                <button type="submit">Cập Nhật</button>
            </form>
        </div>
    </div>

    <script src="~/js/hosobn.js"></script> <!-- Đường dẫn tới JavaScript -->

    <script>
        // Hàm để mở form thêm mới bệnh nhân
        function showAddForm() {
            document.getElementById('addPatientFormModal').style.display = 'block';
        }

        // Hàm để mở form sửa bệnh nhân với dữ liệu đã có
        function editPatient(id, phone, description) {
            // Cập nhật tiêu đề form sửa
            document.getElementById('editPatientFormModal').style.display = 'block';
            
            // Điền dữ liệu vào form sửa
            document.getElementById('patientId').value = id;
            document.getElementById('editPatientPhone').value = phone;
            document.getElementById('editPatientDescription').value = description;
        }

        // Hàm để ẩn form
        function hideForm() {
            document.getElementById('addPatientFormModal').style.display = 'none';
            document.getElementById('editPatientFormModal').style.display = 'none';
        }
    </script>
</body>
